<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="yuqimiao" />

<meta name="date" content="2020-10-06" />

<title>GL_SIMLR</title>

<script src="site_libs/header-attrs-2.1/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">multiomics-SIMLR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/yuqimiao/multiomics-SIMLR">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">GL_SIMLR</h1>
<h4 class="author">yuqimiao</h4>
<h4 class="date">2020-10-06</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-01-10
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>multiomics-SIMLR/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200830code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200830)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200830code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200830)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomyuqimiaomultiomicsSIMLRtree3a16da9cacd5cfddbedf0fc89f95d75788a30f07targetblank3a16da9a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/yuqimiao/multiomics-SIMLR/tree/3a16da9cacd5cfddbedf0fc89f95d75788a30f07" target="_blank">3a16da9</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomyuqimiaomultiomicsSIMLRtree3a16da9cacd5cfddbedf0fc89f95d75788a30f07targetblank3a16da9a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/yuqimiao/multiomics-SIMLR/tree/3a16da9cacd5cfddbedf0fc89f95d75788a30f07" target="_blank">3a16da9</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    code/.DS_Store
    Ignored:    code/R/.DS_Store
    Ignored:    code/functions/.DS_Store
    Ignored:    code/functions/.Rhistory
    Ignored:    data/.DS_Store

Untracked files:
    Untracked:  SIMLR-tracking.md
    Untracked:  analysis/GL_simlr_micro.rmd
    Untracked:  analysis/derivation_of_weights.jpeg
    Untracked:  analysis/indi_spec_weight.rmd
    Untracked:  code/MKerW-A/
    Untracked:  code/bck_scripts/
    Untracked:  code/cluster_functions/
    Untracked:  code/functions/Changing_rho.R
    Untracked:  code/functions/Code_5term_opt-copy.R
    Untracked:  code/functions/Code_5term_opt.R
    Untracked:  code/functions/SIMLR_no_weights.R
    Untracked:  code/functions/dist_kernels.R
    Untracked:  code/functions/gl_simlr.R
    Untracked:  code/functions/gl_simlr2.0.R
    Untracked:  code/functions/kernel_validation.R
    Untracked:  code/functions/microb_compare.R
    Untracked:  code/functions/simulation_function1.0.R
    Untracked:  code/functions/simulation_tidy.R
    Untracked:  code/functions/tmp.R
    Untracked:  code/ind_weight_simulation.R
    Untracked:  code/microb_apply/
    Untracked:  code/simulation_0106.R
    Untracked:  code/simulation_1224.R
    Untracked:  code/simulation_1229.R
    Untracked:  code/simulation_compare2.R
    Untracked:  code/simulation_compare3.R
    Untracked:  code/simulation_compare_size.R
    Untracked:  data/balance_24_table.Rdata
    Untracked:  data/configuration_data_40.Rdata
    Untracked:  data/eff37_24_table.Rdata
    Untracked:  data/example_data/
    Untracked:  data/ind_weight_simulation/
    Untracked:  data/micro_case_pool.Rdata
    Untracked:  data/micro_case_pool_2.Rdata
    Untracked:  data/simu_0106/
    Untracked:  data/simu_1215/
    Untracked:  data/simu_1220/
    Untracked:  data/simu_1229/
    Untracked:  data/simu_all/
    Untracked:  data/simulation_2data/
    Untracked:  data/simulation_data_var10_s4/
    Untracked:  data/simulation_data_var20_s4/
    Untracked:  data/simulation_gl/
    Untracked:  data/simulation_gl_1/
    Untracked:  data/simulation_microgl/
    Untracked:  data/simulation_microgl_1/
    Untracked:  data/simulation_normalization/
    Untracked:  data/simulation_rho/
    Untracked:  data/simulation_var10_50/
    Untracked:  data/simulation_var5_50/
    Untracked:  data/table_balance_3d3g.Rdata
    Untracked:  gl-simlr_old_analysis.Rmd
    Untracked:  individual_spec_weight.html
    Untracked:  micro_abd.Rdata
    Untracked:  micro_abd_preabs.Rdata
    Untracked:  micro_case_pool2.Rdata
    Untracked:  microb_multisim.Rdata
    Untracked:  new_micro.jpeg
    Untracked:  parameter_separation/
    Untracked:  sub111_eff55_u20.rds
    Untracked:  tsne/

Unstaged changes:
    Deleted:    analysis/sim_report.rmd
    Modified:   analysis/trivial_analysis.rmd
    Modified:   code/R/utils.simlr.R
    Deleted:    code/functions/SNF_init_generater.R
    Deleted:    code/functions/kernel_buiding_functions.R
    Deleted:    code/functions/multiple.kernel.verify.R
    Modified:   code/functions/simulation_function.R
    Modified:   code/functions/simulation_verify.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/GL_SIMLR.rmd</code>) and HTML (<code>docs/GL_SIMLR.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/3a16da9cacd5cfddbedf0fc89f95d75788a30f07/analysis/GL_SIMLR.rmd" target="_blank">3a16da9</a>
</td>
<td>
yuqimiao
</td>
<td>
2021-01-10
</td>
<td>
exploration on why gl-simlr not working on div4
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yuqimiao/multiomics-SIMLR/2a5559a580c6a86335a22ae019e069fba7b9d5a4/docs/GL_SIMLR.html" target="_blank">2a5559a</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/8bae42eb34e8bf5e61ab011359846996f6275b8d/analysis/GL_SIMLR.rmd" target="_blank">8bae42e</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-30
</td>
<td>
update weights plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yuqimiao/multiomics-SIMLR/93bec728ef00790f685ed490bf3a3b068b813533/docs/GL_SIMLR.html" target="_blank">93bec72</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/04072870695ac26f6f74972ef7d740bdf186289e/analysis/GL_SIMLR.rmd" target="_blank">0407287</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
gl-simlr plotly
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yuqimiao/multiomics-SIMLR/6eb40123153a96fbefac1c1ed80fb3823f725061/docs/GL_SIMLR.html" target="_blank">6eb4012</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/c74750325aaf716b7f50898f56b2a9b5da0a4322/analysis/GL_SIMLR.rmd" target="_blank">c747503</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
gl-simlr analysis update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yuqimiao/multiomics-SIMLR/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/GL_SIMLR.html" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/7bea59cb6b646423ca74cbbc15f790406972a14e/analysis/GL_SIMLR.rmd" target="_blank">7bea59c</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
<td>
wflow_publish(files = c(“analysis/GL_SIMLR.rmd”, “analysis/trivial_analysis.rmd”))
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<p>This is the exploration analysis page for the Global Local SIMLR algorithm</p>
<p>The main thoughts of the new algorithm is to using both the local and global information in weight optimization, the details is in Derivation/GL_SIMLR.pdf</p>
<pre class="r"><code>## package loading
library(tidyverse)</code></pre>
<pre><code>── Attaching packages ───────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>✓ ggplot2 3.3.0     ✓ purrr   0.3.3
✓ tibble  3.0.0     ✓ dplyr   0.8.5
✓ tidyr   1.0.2     ✓ stringr 1.4.0
✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>── Conflicts ──────────────────────────────────────────── tidyverse_conflicts() ──
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(parallel)
library(clValid)</code></pre>
<pre><code>Loading required package: cluster</code></pre>
<pre class="r"><code>library(abSNF)
library(SNFtool)</code></pre>
<pre><code>
Attaching package: &#39;SNFtool&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:abSNF&#39;:

    affinityMatrix, dist2, SNF, spectralClustering,
    standardNormalization</code></pre>
<pre class="r"><code>library(igraph)</code></pre>
<pre><code>
Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:clValid&#39;:

    clusters</code></pre>
<pre><code>The following objects are masked from &#39;package:dplyr&#39;:

    as_data_frame, groups, union</code></pre>
<pre><code>The following objects are masked from &#39;package:purrr&#39;:

    compose, simplify</code></pre>
<pre><code>The following object is masked from &#39;package:tidyr&#39;:

    crossing</code></pre>
<pre><code>The following object is masked from &#39;package:tibble&#39;:

    as_data_frame</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    decompose, spectrum</code></pre>
<pre><code>The following object is masked from &#39;package:base&#39;:

    union</code></pre>
<pre class="r"><code>library(Matrix)</code></pre>
<pre><code>
Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:tidyr&#39;:

    expand, pack, unpack</code></pre>
<pre class="r"><code>library(quadprog)
# library(CancerSubtypes)

## mwe data
source(&quot;code/functions/simulation_function.R&quot;)
source(&quot;code/R/compute.multiple.kernel.R&quot;)
source(&quot;code/functions/simulation_verify.R&quot;)</code></pre>
<pre><code>
Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    lowess</code></pre>
<pre class="r"><code>source(&quot;./code/functions/gl_simlr.R&quot;)
source(&quot;./code/functions/gl_simlr2.0.R&quot;)</code></pre>
<div id="example-usage" class="section level1">
<h1>example usage</h1>
<p>For the example run, using simulation scenario where the effective size are 2,3,5 respectively for 3 data types. separating cluster 12/34,13/24,14/23 separately.</p>
<p>More scenario will be include in simulation</p>
<pre class="r"><code>set.seed(124)
sim = simulation_3(eff_size = c(2,3,5), sigma = rep(100,3))
data_list = list(data1 = standardNormalization(t(sim$data1)),
                 data2 = standardNormalization(t(sim$data2)),
                 data3 = standardNormalization(t(sim$data3)))
## GL_SIMLR_1 
gl_result = GL_SIMLR_1(data_list = data_list)</code></pre>
<pre><code>Warning in GL_SIMLR_1(data_list = data_list): Maybe you should set a larger
value of c.</code></pre>
<pre class="r"><code>gl_result_3 = GL_SIMLR_4(data_list = data_list)


igraph::compare(gl_result$cluster,sim$truelabel,method = &quot;rand&quot;)</code></pre>
<pre><code>[1] 0.711005</code></pre>
<pre class="r"><code>igraph::compare(gl_result_3$cluster,sim$truelabel,method = &quot;rand&quot;)</code></pre>
<pre><code>[1] 0.7886935</code></pre>
<pre class="r"><code>igraph::compare(gl_result$cluster,sim$truelabel,method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.5038792</code></pre>
<pre class="r"><code>igraph::compare(gl_result_3$cluster,sim$truelabel,method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.469846</code></pre>
<pre class="r"><code>gl_result$w_list</code></pre>
<pre><code>[1] 0.2294180 0.3913369 0.3792452</code></pre>
<pre class="r"><code>gl_result_3$w_list</code></pre>
<pre><code># A tibble: 3 x 1
  w_list
   &lt;dbl&gt;
1  0.333
2  0.333
3  0.333</code></pre>
<pre class="r"><code>gl_result$cluster</code></pre>
<pre><code>  [1] 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 4 1 1 1 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 [75] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 1 3 3 3 3 3
[149] 3 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 3 1 3 1 1 1 1 1 1 1 1
[186] 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1</code></pre>
<pre class="r"><code>gl_result_3$cluster</code></pre>
<pre><code>  [1] 2 2 2 2 2 1 2 2 2 2 2 3 2 1 2 2 1 2 2 2 2 2 2 1 2 1 2 4 2 2 2 1 2 2 2 2 2
 [38] 2 2 2 2 1 2 2 4 2 2 2 2 2 3 4 4 4 2 1 3 4 4 4 4 3 4 3 3 3 4 3 4 4 4 3 3 3
 [75] 3 3 4 3 4 4 4 3 3 4 4 4 4 4 4 3 4 4 4 3 3 4 4 3 4 3 2 4 2 3 2 4 4 4 3 4 3
[112] 3 4 3 4 4 3 3 3 4 3 4 3 3 4 4 4 3 3 3 4 3 4 3 1 4 4 2 4 3 3 4 4 4 3 3 4 4
[149] 3 3 1 1 2 1 4 1 1 1 1 1 2 2 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[186] 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1</code></pre>
<pre class="r"><code>sort(desc(gl_result$converge),index.return = T)</code></pre>
<pre><code>$x
 [1] -0.4887217 -0.4885730 -0.4885458 -0.4885406 -0.4885396 -0.4885393
 [7] -0.4885393 -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392
[13] -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392
[19] -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392
[25] -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392 -0.4885392
[31] -0.4885392 -0.4885392 -0.4885392

$ix
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 33 32</code></pre>
<pre class="r"><code>gl_result_3$converge</code></pre>
<pre><code> [1] -0.1098612 -0.1098612 -0.1098612 -0.1098612 -0.1098612 -0.1098612
 [7] -0.1098612 -0.1098612 -0.1098612 -0.1098612 -0.1098612</code></pre>
<pre class="r"><code>gl_result$converge</code></pre>
<pre><code> [1] 0.4887217 0.4885730 0.4885458 0.4885406 0.4885396 0.4885393 0.4885393
 [8] 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392
[15] 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392
[22] 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392
[29] 0.4885392 0.4885392 0.4885392 0.4885392 0.4885392</code></pre>
</div>
<div id="term-configuration" class="section level1">
<h1>1 term configuration</h1>
<pre class="r"><code>## show the major contribution of weight from trace term
## one time, iteration compare the relationship between GL_trace and weight
par = list()
sub_ratio_ls = list(rep(1/4,4), c(0.1,0.2,0.3,0.4))
sample_size_ls = c(120,200)
eff_size_ls = list(c(1,1,1),c(1,3,3),c(1,3,5))
sigma_ls = c(1,10,100)
load(&quot;./data/configuration_data_40.Rdata&quot;)

g1 = as_tibble(W_g$GL_trace_all) %&gt;% 
  mutate(ID = seq_along(V1)) %&gt;% 
  pivot_longer(
    V1:V3,
    names_to = &quot;data_type&quot;,
    values_to = &quot;GL_trace&quot;
  ) %&gt;% 
  ggplot(aes(x = ID, y = GL_trace, color = data_type, group = data_type))+
  geom_line()+
  facet_grid(data_type~., scale = &quot;free&quot;)</code></pre>
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.
Using compatibility `.name_repair`.
This warning is displayed once every 8 hours.
Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre class="r"><code>g2 = as_tibble(W_g$w_list_all) %&gt;% 
  mutate(ID = seq_along(V1)) %&gt;% 
  pivot_longer(
    V1:V3,
    names_to = &quot;data_type&quot;,
    values_to = &quot;weight&quot;
  ) %&gt;% 
  ggplot(aes(x = ID, y = weight, color = data_type, group = data_type))+
  geom_line()+
  facet_grid(data_type~., scale = &quot;free&quot;)
library(patchwork)
g1+g2</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-3-1.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>## load simulated data
eva_nmi = NULL
eva_rand = NULL
gl_weight = NULL
global_local = NULL
GL_trace = NULL
tunning_crit = NULL
gl_weight = NULL
tunning_best = NULL
files = list.files(&quot;./data/simu_1220/&quot;)
for(i in 1:length(files)){
  load(file = paste(&quot;./data/simu_1220/&quot;, files[i], sep = &quot;&quot;))
  eva_nmi = rbind(eva_nmi,res$eva_nmi)
  eva_rand = rbind(eva_rand, res$eva_rand)
  gl_weight = rbind(gl_weight, res$gl_weight)
  global_local = rbind(global_local, res$global_local)
  GL_trace = rbind(GL_trace,res$GL_trace)
  tunning_crit = rbind(tunning_crit, res$tunning_res)
  tunning_best = rbind(tunning_best, res$tunning_best)
  gl_weight = rbind(gl_weight, res$gl_weight)
}
# scenario_name = c(paste(&quot;n120&quot;, c(paste(&quot;eff111&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;),
#                                      paste(&quot;eff133&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;),
#                                      paste(&quot;eff135&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;)),
#                         sep = &quot;_&quot;),
#                   paste(&quot;n200&quot;, c(paste(&quot;eff111&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;),
#                                      paste(&quot;eff133&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;),
#                                      paste(&quot;eff135&quot;, paste(&quot;sig&quot;,sigma_ls, sep = &quot;&quot;),sep = &quot;_&quot;)),
#                         sep = &quot;_&quot;)
# )
# scenario_n = rep(scenario_name,100)

## show that no clear difference between with/without beta
eva_nmi %&gt;% 
    # mutate(scenario = scenario_n) %&gt;% 
    group_by(scenario) %&gt;%
    summarise_all(mean)</code></pre>
<pre><code># A tibble: 18 x 15
   scenario nmi_kmean1 nmi_kmean2 nmi_kmean_c nmi_hclust1 nmi_hclust2
   &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
 1 n120_ef…     0.527      0.526       0.967       0.544       0.539 
 2 n120_ef…     0.175      0.161       0.143       0.0538      0.0610
 3 n120_ef…     0.0308     0.0315      0.0315      0.0308      0.0318
 4 n120_ef…     0.524      0.527       0.937       0.540       0.538 
 5 n120_ef…     0.172      0.528       0.943       0.0554      0.542 
 6 n120_ef…     0.0312     0.134       0.0844      0.0320      0.0469
 7 n120_ef…     0.526      0.527       0.891       0.535       0.540 
 8 n120_ef…     0.169      0.527       0.903       0.0548      0.541 
 9 n120_ef…     0.0331     0.132       0.376       0.0334      0.0479
10 n200_ef…     0.521      0.522       0.958       0.537       0.536 
11 n200_ef…     0.239      0.239       0.199       0.0384      0.0381
12 n200_ef…     0.0185     0.0197      0.0209      0.0193      0.0198
13 n200_ef…     0.522      0.524       0.949       0.539       0.541 
14 n200_ef…     0.240      0.521       0.936       0.0380      0.539 
15 n200_ef…     0.0198     0.188       0.0850      0.0195      0.0340
16 n200_ef…     0.522      0.519       0.897       0.536       0.537 
17 n200_ef…     0.247      0.523       0.875       0.0393      0.535 
18 n200_ef…     0.0201     0.187       0.458       0.0193      0.0383
# … with 9 more variables: nmi_hclust_c &lt;dbl&gt;, nmi_spec1 &lt;dbl&gt;,
#   nmi_spec2 &lt;dbl&gt;, nmi_spec_c &lt;dbl&gt;, nmi_spec_s &lt;dbl&gt;, nmi_spec_abs &lt;dbl&gt;,
#   nmi_spec_g &lt;dbl&gt;, nmi_spec_g_nobeta &lt;dbl&gt;, nmi_spec_gt &lt;dbl&gt;</code></pre>
<pre class="r"><code>eva_rand %&gt;% 
  group_by(scenario) %&gt;%
  summarise_all(mean)</code></pre>
<pre><code># A tibble: 18 x 15
   scenario rand_kmean1 rand_kmean2 rand_kmean_c rand_hclust1 rand_hclust2
   &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 n120_ef…       0.751       0.751        0.974        0.751        0.751
 2 n120_ef…       0.671       0.668        0.666        0.581        0.586
 3 n120_ef…       0.626       0.626        0.626        0.582        0.577
 4 n120_ef…       0.751       0.751        0.950        0.751        0.751
 5 n120_ef…       0.671       0.752        0.955        0.586        0.751
 6 n120_ef…       0.626       0.660        0.644        0.572        0.589
 7 n120_ef…       0.751       0.751        0.914        0.750        0.751
 8 n120_ef…       0.670       0.751        0.924        0.588        0.751
 9 n120_ef…       0.627       0.659        0.729        0.578        0.586
10 n200_ef…       0.751       0.751        0.967        0.750        0.751
11 n200_ef…       0.693       0.693        0.693        0.584        0.588
12 n200_ef…       0.626       0.627        0.626        0.584        0.575
13 n200_ef…       0.751       0.751        0.960        0.750        0.751
14 n200_ef…       0.693       0.751        0.950        0.583        0.750
15 n200_ef…       0.626       0.679        0.648        0.577        0.581
16 n200_ef…       0.751       0.751        0.919        0.750        0.751
17 n200_ef…       0.695       0.751        0.902        0.590        0.750
18 n200_ef…       0.627       0.679        0.750        0.581        0.592
# … with 9 more variables: rand_hclust_c &lt;dbl&gt;, rand_spec1 &lt;dbl&gt;,
#   rand_spec2 &lt;dbl&gt;, rand_spec_c &lt;dbl&gt;, rand_spec_s &lt;dbl&gt;,
#   rand_spec_abs &lt;dbl&gt;, rand_spec_g &lt;dbl&gt;, rand_spec_g_nobeta &lt;dbl&gt;,
#   rand_spec_gt &lt;dbl&gt;</code></pre>
<pre class="r"><code>eva_nmi %&gt;% 
  group_by(scenario) %&gt;%
  summarise_all(mean) %&gt;% 
  pivot_longer(
    nmi_spec_s:nmi_spec_gt,
    names_to = &quot;methods&quot;,
    values_to = &quot;nmi&quot;
  ) %&gt;% 
  separate(scenario, into = c(&quot;size&quot;,&quot;eff_size&quot;,&quot;sigma&quot;),sep = &quot;_&quot;) %&gt;% 
  ggplot(aes(x = eff_size, y = nmi, group = methods, color = methods))+
  geom_line(alpha = 0.5)+
  geom_point(alpha = 0.5)+
  facet_grid(size~sigma)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-4-1.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>eva_rand  %&gt;% 
  group_by(scenario) %&gt;%
  summarise_all(mean) %&gt;% 
  pivot_longer(
    rand_spec_c:rand_spec_gt,
    names_to = &quot;methods&quot;,
    values_to = &quot;rand&quot;
  ) %&gt;% 
  separate(scenario, into = c(&quot;size&quot;,&quot;eff_size&quot;,&quot;sigma&quot;),sep = &quot;_&quot;) %&gt;% 
  ggplot(aes(x = eff_size, y = rand, group = methods, color = methods))+
  geom_line(alpha = 0.5)+
  geom_point(alpha = 0.5)+
  facet_grid(size~sigma)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-2">
Past versions of unnamed-chunk-4-2.png
</button>
</p>
<div id="fig-unnamed-chunk-4-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-4-2.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>eva_rand %&gt;% 
  # mutate(scenario = scenario_n) %&gt;% 
  dplyr::select(scenario = scenario, concatenate = rand_spec_c, MKL = rand_spec_g, snf = rand_spec_s) %&gt;% 
  group_by(scenario) %&gt;%
  summarise_all(mean) %&gt;% 
  pivot_longer(
    concatenate:snf,
    names_to = &quot;methods&quot;,
    values_to = &quot;rand&quot;
  ) %&gt;% 
  separate(scenario, into = c(&quot;size&quot;,&quot;eff_size&quot;,&quot;sigma&quot;),sep = &quot;_&quot;) %&gt;% 
  ggplot(aes(x = eff_size, y = rand, group = methods, color = methods))+
  geom_line(alpha = 0.5)+
  geom_point(alpha = 0.5)+
  facet_grid(size~sigma)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-4-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-3">
Past versions of unnamed-chunk-4-3.png
</button>
</p>
<div id="fig-unnamed-chunk-4-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-4-3.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>### show the trivial distance between glocal and local term
global_local %&gt;%
  # mutate(scenario = rep(scenario_n,each = 3)) %&gt;% 
  mutate(scenario = str_replace_all(scenario,&quot;[a-z]&quot;,&quot;&quot;)) %&gt;%
  group_by(scenario,type) %&gt;%
  summarise_all(mean) %&gt;% 
  pivot_longer(
    global_GL:local_GL_tunn,
    names_to = &quot;term&quot;,
    values_to = &quot;value&quot;
  ) %&gt;%
  ggplot(aes(x = scenario, y = value, color = as.factor(type), group = as.factor(type)))+
  geom_line()+
  facet_grid(term~.)+
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-5-1.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>g1 = global_local %&gt;%
  # mutate(scenario = rep(scenario_n,each = 3)) %&gt;% 
  mutate(scenario = str_replace_all(scenario,&quot;[a-z]&quot;,&quot;&quot;)) %&gt;%
  group_by(scenario,type) %&gt;%
  summarise_all(mean) %&gt;% 
  filter(str_detect(scenario,&quot;120&quot;)) %&gt;% 
  pivot_longer(
    global_GL:local_GL_tunn,
    names_to = &quot;term&quot;,
    values_to = &quot;value&quot;
  ) %&gt;%
  ggplot(aes(x = scenario, y = value, color = as.factor(type), group = as.factor(type)))+
  geom_line()+
  facet_grid(term~.)

g2 = global_local %&gt;%
  # mutate(scenario = rep(scenario_n,each = 3)) %&gt;% 
  mutate(scenario = str_replace_all(scenario,&quot;[a-z]&quot;,&quot;&quot;)) %&gt;%
  group_by(scenario,type) %&gt;%
  summarise_all(mean) %&gt;% 
  filter(str_detect(scenario,&quot;200&quot;)) %&gt;% 
  pivot_longer(
    global_GL:local_GL_tunn,
    names_to = &quot;term&quot;,
    values_to = &quot;value&quot;
  ) %&gt;%
  ggplot(aes(x = scenario, y = value, color = as.factor(type), group = as.factor(type)))+
  geom_line()+
  facet_grid(term~.)
g1/g2</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-2">
Past versions of unnamed-chunk-5-2.png
</button>
</p>
<div id="fig-unnamed-chunk-5-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-5-2.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>show the contribution of global/local term</p>
<pre class="r"><code>gl_weight %&gt;%
  # mutate(scenario = rep(scenario_n,each = 3)) %&gt;% 
  mutate(scenario = str_replace_all(scenario,&quot;[a-z]&quot;,&quot;&quot;)) %&gt;%
  group_by(scenario,type) %&gt;%
  summarise_all(mean) %&gt;%
  pivot_longer(
    GL:GL_nbeta,
    names_to = &quot;term&quot;,
    values_to = &quot;value&quot;
  ) %&gt;%
  ggplot(aes(x = scenario, y = value, color = as.factor(type), group = as.factor(type)))+
  geom_line()+
  facet_grid(term~.)+
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yuqimiao/multiomics-SIMLR/blob/5c82629c31c5fdd5971f879bf34fb9748cde3ed8/docs/figure/GL_SIMLR.rmd/unnamed-chunk-6-1.png" target="_blank">5c82629</a>
</td>
<td>
yuqimiao
</td>
<td>
2020-12-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>## show the comparability of Global-local term and the GL_trace

compare_gl_term = 
  global_local %&gt;% 
  mutate(simulation = rep(1:100, each = 54)) %&gt;% 
  group_by(simulation,scenario) %&gt;% 
  mutate_all(function(x)(x-mean(x)))%&gt;% 
  ungroup(simulation,scenario) %&gt;% 
  group_by(scenario,type) %&gt;% 
  summarise_all(mean)</code></pre>
<pre><code>`mutate_all()` ignored the following grouping variables:
Columns `simulation`, `scenario`
Use `mutate_at(df, vars(-group_cols()), myoperation)` to silence the message.</code></pre>
<pre class="r"><code>compare_trace_term = 
  GL_trace %&gt;% 
  mutate(simulation = rep(1:100, each = 54)) %&gt;% 
  group_by(simulation,scenario) %&gt;% 
  mutate_all(function(x)(x-mean(x))) %&gt;% 
  ungroup(simulation,scenario) %&gt;% 
  group_by(scenario,type) %&gt;% 
  summarise_all(mean)</code></pre>
<pre><code>`mutate_all()` ignored the following grouping variables:
Columns `simulation`, `scenario`
Use `mutate_at(df, vars(-group_cols()), myoperation)` to silence the message.</code></pre>
<pre class="r"><code>compare_gl_term</code></pre>
<pre><code># A tibble: 54 x 9
# Groups:   scenario [18]
   scenario  type global_GL global_GL_nbeta global_GL_tunn local_GL
   &lt;fct&gt;    &lt;dbl&gt;     &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;
 1 n120_ef…    -1   2.12e-6       0.0000146    0.000000587  2.09e-6
 2 n120_ef…     0   7.41e-7      -0.0000594   -0.00000181  -8.15e-5
 3 n120_ef…     1  -2.86e-6       0.0000448    0.00000122   7.94e-5
 4 n120_ef…    -1  -3.05e-6       0.000302     0.00000444   1.74e-4
 5 n120_ef…     0   1.95e-6      -0.0000216   -0.00000131   5.58e-6
 6 n120_ef…     1   1.11e-6      -0.000280    -0.00000313  -1.79e-4
 7 n120_ef…    -1   4.83e-6       0.000450     0.00000391   2.42e-4
 8 n120_ef…     0  -1.19e-6       0.0000631    0.00000265  -4.35e-5
 9 n120_ef…     1  -3.64e-6      -0.000513    -0.00000656  -1.99e-4
10 n120_ef…    -1  -5.24e-4      -0.00339     -0.000124    -5.95e-4
# … with 44 more rows, and 3 more variables: local_GL_nbeta &lt;dbl&gt;,
#   local_GL_tunn &lt;dbl&gt;, simulation &lt;dbl&gt;</code></pre>
<pre class="r"><code>compare_trace_term</code></pre>
<pre><code># A tibble: 54 x 6
# Groups:   scenario [18]
   scenario            type         GL    GL_nbeta    GL_tunn simulation
   &lt;fct&gt;              &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 n120_eff111_sig1      -1 -0.0000792  0.000616    0.000787        50.5
 2 n120_eff111_sig1       0  0.0000526 -0.000452   -0.000562        50.5
 3 n120_eff111_sig1       1  0.0000265 -0.000164   -0.000225        50.5
 4 n120_eff111_sig10     -1  0.0000100 -0.0000409  -0.0000803       50.5
 5 n120_eff111_sig10      0  0.000150   0.0000895   0.000119        50.5
 6 n120_eff111_sig10      1 -0.000160  -0.0000486  -0.0000387       50.5
 7 n120_eff111_sig100    -1 -0.000457  -0.0000108  -0.0000488       50.5
 8 n120_eff111_sig100     0  0.000273   0.00000796  0.0000124       50.5
 9 n120_eff111_sig100     1  0.000184   0.00000282  0.0000364       50.5
10 n120_eff133_sig1      -1  0.00983    0.00572     0.00705         50.5
# … with 44 more rows</code></pre>
</div>
<div id="simulation-result-comparison" class="section level1">
<h1>2 simulation result comparison</h1>
<pre class="r"><code>eva_nmi = NULL
eva_rand = NULL
gl_weight = NULL
global_local = NULL
GL_trace = NULL
tunning_crit = NULL
gl_weight = NULL
tunning_best = NULL
files = list.files(&quot;./data/simu_0106/&quot;)
for(i in 1:length(files)){
  load(file = paste(&quot;./data/simu_0106/&quot;, files[i], sep = &quot;&quot;))
  eva_nmi = rbind(eva_nmi,res$eva_nmi)
  eva_rand = rbind(eva_rand, res$eva_rand)
  gl_weight = rbind(gl_weight, res$gl_weight)
}</code></pre>
<div id="nmi-comparison" class="section level2">
<h2>nmi comparison</h2>
<pre class="r"><code>nmi_mean = eva_nmi %&gt;% 
  group_by(scenario) %&gt;% 
  summarise_all(mean) 
  # %&gt;% separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;)</code></pre>
<pre class="r"><code>## per scenario comparison
library(directlabels)
scenario_analysis = function(scenario_name){
  methods_datatype = c(&quot;kmean_1&quot;,&quot;kmean_2&quot;,&quot;kmean_3&quot;,&quot;kmean_12&quot;,&quot;kmean_13&quot;,&quot;kmean_123&quot;,&quot;hclust_1&quot;,&quot;hclust_2&quot;,&quot;hclust_3&quot;,&quot;hclust_12&quot;,&quot;hclust_13&quot;,&quot;hclust_123&quot;,&quot;spec_1&quot;,&quot;spec_2&quot;,&quot;spec_3&quot;,&quot;spec_12&quot;,&quot;spec_13&quot;,&quot;spec_123&quot;,&quot;SNF_12&quot;,&quot;SNF_13&quot;,&quot;SNF_123&quot;,&quot;abSNF_123&quot;,&quot;glSIMLR_12&quot;,&quot;glSIMLR_13&quot;,&quot;glSIMLR_123&quot;,&quot;glSIMLR2_12&quot;,&quot;glSIMLR2_13&quot;,&quot;glSIMLR2_123&quot;,&quot;glSIML2Nogl_12&quot;,&quot;glSIML2Nogl_13&quot;,&quot;glSIML2Nogl_123&quot;)

scenario_case = 
  nmi_mean %&gt;%
  filter(scenario == scenario_name) %&gt;%  ## change the scenario here
  pivot_longer(nmi_kmean1:nmi_spec_g2_nogl,
    names_to = &quot;methods&quot;,
    values_to = &quot;nmi&quot;,
    names_prefix = &quot;nmi_&quot;) %&gt;%
  mutate(methods = methods_datatype) %&gt;% 
  separate(methods, into = c(&quot;methods&quot;, &quot;datatype&quot;),sep = &quot;_&quot;) %&gt;% 
  mutate(datatype = factor(datatype, levels = c(1,2,3,12,13,123)))
  

library(plotly)
p =
  scenario_case %&gt;% 
    ggplot(aes(x = datatype, y = nmi, color = methods, group = methods)) +
    geom_line(alpha = 0.5)+
    geom_point(alpha = 0.7)
ggplotly(p)
}

scenario_analysis(scenario_name = &quot;sub1111_eff111_sig1_div4&quot;)</code></pre>
<pre><code>
Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:igraph&#39;:

    groups</code></pre>
<pre><code>The following object is masked from &#39;package:ggplot2&#39;:

    last_plot</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<pre><code>The following object is masked from &#39;package:graphics&#39;:

    layout</code></pre>
<div id="htmlwidget-61a3ee68e03f2616f3d0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-61a3ee68e03f2616f3d0">{"x":{"data":[{"x":[6],"y":[0.996152254090221],"text":"datatype: 123<br />nmi: 0.9961523<br />methods: abSNF<br />methods: abSNF","type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,0.5)","dash":"solid"},"hoveron":"points","name":"abSNF","legendgroup":"abSNF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[4,5,6],"y":[0.399408797803808,0.397941678063415,0.396105496946067],"text":["datatype: 12<br />nmi: 0.3994088<br />methods: glSIML2Nogl<br />methods: glSIML2Nogl","datatype: 13<br />nmi: 0.3979417<br />methods: glSIML2Nogl<br />methods: glSIML2Nogl","datatype: 123<br />nmi: 0.3961055<br />methods: glSIML2Nogl<br />methods: glSIML2Nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(205,150,0,0.5)","dash":"solid"},"hoveron":"points","name":"glSIML2Nogl","legendgroup":"glSIML2Nogl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(205,150,0,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)"}},"frame":null},{"x":[4,5,6],"y":[0.397062357091247,0.397716088662607,0.396316400637013],"text":["datatype: 12<br />nmi: 0.3970624<br />methods: glSIMLR<br />methods: glSIMLR","datatype: 13<br />nmi: 0.3977161<br />methods: glSIMLR<br />methods: glSIMLR","datatype: 123<br />nmi: 0.3963164<br />methods: glSIMLR<br />methods: glSIMLR"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(124,174,0,0.5)","dash":"solid"},"hoveron":"points","name":"glSIMLR","legendgroup":"glSIMLR","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)"}},"frame":null},{"x":[4,5,6],"y":[0.39844526324133,0.403927516504283,0.404223991303626],"text":["datatype: 12<br />nmi: 0.3984453<br />methods: glSIMLR2<br />methods: glSIMLR2","datatype: 13<br />nmi: 0.4039275<br />methods: glSIMLR2<br />methods: glSIMLR2","datatype: 123<br />nmi: 0.4042240<br />methods: glSIMLR2<br />methods: glSIMLR2"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,190,103,0.5)","dash":"solid"},"hoveron":"points","name":"glSIMLR2","legendgroup":"glSIMLR2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,190,103,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)"}},"frame":null},{"x":[1,2,3,4,5,6],"y":[0.637823090192127,0.63076806542112,0.630340078197667,0.78110834161529,0.783785557462928,0.884609859231738],"text":["datatype: 1<br />nmi: 0.6378231<br />methods: hclust<br />methods: hclust","datatype: 2<br />nmi: 0.6307681<br />methods: hclust<br />methods: hclust","datatype: 3<br />nmi: 0.6303401<br />methods: hclust<br />methods: hclust","datatype: 12<br />nmi: 0.7811083<br />methods: hclust<br />methods: hclust","datatype: 13<br />nmi: 0.7837856<br />methods: hclust<br />methods: hclust","datatype: 123<br />nmi: 0.8846099<br />methods: hclust<br />methods: hclust"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,196,0.5)","dash":"solid"},"hoveron":"points","name":"hclust","legendgroup":"hclust","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"frame":null},{"x":[1,2,3,4,5,6],"y":[0.876121520930915,0.887306831596097,0.875057327810241,0.890617111506045,0.882582756769631,0.88907111246809],"text":["datatype: 1<br />nmi: 0.8761215<br />methods: kmean<br />methods: kmean","datatype: 2<br />nmi: 0.8873068<br />methods: kmean<br />methods: kmean","datatype: 3<br />nmi: 0.8750573<br />methods: kmean<br />methods: kmean","datatype: 12<br />nmi: 0.8906171<br />methods: kmean<br />methods: kmean","datatype: 13<br />nmi: 0.8825828<br />methods: kmean<br />methods: kmean","datatype: 123<br />nmi: 0.8890711<br />methods: kmean<br />methods: kmean"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,169,255,0.5)","dash":"solid"},"hoveron":"points","name":"kmean","legendgroup":"kmean","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,169,255,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)"}},"frame":null},{"x":[4,5,6],"y":[0.969616457766898,0.968762124535958,0.992237764802893],"text":["datatype: 12<br />nmi: 0.9696165<br />methods: SNF<br />methods: SNF","datatype: 13<br />nmi: 0.9687621<br />methods: SNF<br />methods: SNF","datatype: 123<br />nmi: 0.9922378<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(199,124,255,0.5)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)"}},"frame":null},{"x":[1,2,3,4,5,6],"y":[0.616684405295569,0.605632878141966,0.606591085220075,0.749197952242497,0.736770999787641,0.767852725009227],"text":["datatype: 1<br />nmi: 0.6166844<br />methods: spec<br />methods: spec","datatype: 2<br />nmi: 0.6056329<br />methods: spec<br />methods: spec","datatype: 3<br />nmi: 0.6065911<br />methods: spec<br />methods: spec","datatype: 12<br />nmi: 0.7491980<br />methods: spec<br />methods: spec","datatype: 13<br />nmi: 0.7367710<br />methods: spec<br />methods: spec","datatype: 123<br />nmi: 0.7678527<br />methods: spec<br />methods: spec"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(255,97,204,0.5)","dash":"solid"},"hoveron":"points","name":"spec","legendgroup":"spec","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(255,97,204,1)","opacity":0.7,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)"}},"frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,6.6],"tickmode":"array","ticktext":["1","2","3","12","13","123"],"tickvals":[1,2,3,4,5,6],"categoryorder":"array","categoryarray":["1","2","3","12","13","123"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"datatype","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.36610315908886,1.02615459194743],"tickmode":"array","ticktext":["0.4","0.6","0.8","1.0"],"tickvals":[0.4,0.6,0.8,1],"categoryorder":"array","categoryarray":["0.4","0.6","0.8","1.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"nmi","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"methods","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"169524ae636fb":{"x":{},"y":{},"colour":{},"type":"scatter"},"169525023bf27":{"x":{},"y":{},"colour":{}}},"cur_data":"169524ae636fb","visdat":{"169524ae636fb":["function (y) ","x"],"169525023bf27":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>nmi_balanced_div2 = nmi_mean %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;% 
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div2&quot;) %&gt;% 
  dplyr::select(eff, sigma,concatenation = nmi_spec_c, SNF = nmi_spec_s, absnf = nmi_spec_abs, gl = nmi_spec_g2, gl_nogl = nmi_spec_g2_nogl) %&gt;% 
  pivot_longer(
    concatenation:gl_nogl,
    names_to = &quot;methods&quot;,
    values_to = &quot;nmi&quot;
  ) %&gt;% 
  # filter(str_detect(methods, &quot;gl&quot;)) %&gt;% 
  ggplot(aes(x = eff, y = nmi, color = methods, group = methods))+
  geom_line()+
  geom_point()+
  facet_grid(sigma~.)+
  theme(legend.position = &quot;bottom&quot;)+
  ggtitle(&quot;balanced_div2&quot;)

nmi_balanced_div4 = nmi_mean %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;% 
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div4&quot;) %&gt;% 
  dplyr::select(eff, sigma,concatenation = nmi_spec_c, SNF = nmi_spec_s, absnf = nmi_spec_abs, gl = nmi_spec_g2, gl_nogl = nmi_spec_g2_nogl) %&gt;% 
  pivot_longer(
    concatenation:gl_nogl,
    names_to = &quot;methods&quot;,
    values_to = &quot;nmi&quot;
  ) %&gt;% 
  # filter(str_detect(methods, &quot;gl&quot;)) %&gt;% 
  ggplot(aes(x = eff, y = nmi, color = methods, group = methods))+
  geom_line()+
  geom_point()+
  facet_grid(sigma~.)+
  theme(legend.position = &quot;bottom&quot;)+
  ggtitle(&quot;balanced_div4&quot;)
library(patchwork)
# nmi_balanced_div2+nmi_balanced_div4</code></pre>
<pre class="r"><code>library(plotly)
ggplotly(p = nmi_balanced_div2)</code></pre>
<div id="htmlwidget-e9d5daa14a86c2219833" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9d5daa14a86c2219833">{"x":{"data":[{"x":[1,2,3],"y":[0.70151256686141,1,1],"text":["eff: eff110<br />nmi: 0.70151257<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 1.00000000<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 1.00000000<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.280004392535105,0.548051511715981,0.958425812948135],"text":["eff: eff110<br />nmi: 0.28000439<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 0.54805151<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 0.95842581<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0187486881850729,0.0197458871187541,0.428001133792628],"text":["eff: eff110<br />nmi: 0.01874869<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 0.01974589<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 0.42800113<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.696393267241494,1,1],"text":["eff: eff110<br />nmi: 0.69639327<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 1.00000000<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 1.00000000<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.17843944826617,0.29188713961534,0.997392454018397],"text":["eff: eff110<br />nmi: 0.17843945<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 0.29188714<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 0.99739245<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0154723819615714,0.0201692956083293,0.352822682016944],"text":["eff: eff110<br />nmi: 0.01547238<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 0.02016930<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 0.35282268<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.885258400740955,0.991755294142137,0.999057982988689],"text":["eff: eff110<br />nmi: 0.88525840<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.99175529<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.99905798<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[0.144392652727016,0.202032963253784,0.894785452305893],"text":["eff: eff110<br />nmi: 0.14439265<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.20203296<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.89478545<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[0.017164480399512,0.0205605502299625,0.265638557584652],"text":["eff: eff110<br />nmi: 0.01716448<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.02056055<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.26563856<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[1,1,1],"text":["eff: eff110<br />nmi: 1.00000000<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 1.00000000<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 1.00000000<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.143343363579394,0.22162557904008,0.97070083713508],"text":["eff: eff110<br />nmi: 0.14334336<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 0.22162558<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 0.97070084<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0167179464481388,0.0209745554461397,0.338202295428761],"text":["eff: eff110<br />nmi: 0.01671795<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 0.02097456<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 0.33820230<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.696756388311224,1,1],"text":["eff: eff110<br />nmi: 0.69675639<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 1.00000000<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 1.00000000<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null},{"x":[1,2,3],"y":[0.103758101029532,0.149077140099395,0.802544111728682],"text":["eff: eff110<br />nmi: 0.10375810<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 0.14907714<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 0.80254411<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0176990933471623,0.0183615993094351,0.309044273223792],"text":["eff: eff110<br />nmi: 0.01769909<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 0.01836160<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 0.30904427<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":18.9954337899543,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"balanced_div2","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["eff110","eff111","eff135"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["eff110","eff111","eff135"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"annotations":[{"text":"eff","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"nmi","x":-0.0510980647966949,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"sig1","x":1,"y":0.840943683409437,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"sig10","x":1,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"sig100","x":1,"y":0.159056316590563,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"methods","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0.681887366818874,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.03375399894035,1.04922638090192],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.681887366818874,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.681887366818874,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.34855403348554,"y1":0.65144596651446},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.34855403348554,"y1":0.65144596651446,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.318112633181126},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.318112633181126,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.03375399894035,1.04922638090192],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.34855403348554,0.65144596651446],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.03375399894035,1.04922638090192],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.318112633181126],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"169525d2aa8ef":{"x":{},"y":{},"colour":{},"type":"scatter"},"169521bb912b2":{"x":{},"y":{},"colour":{}}},"cur_data":"169525d2aa8ef","visdat":{"169525d2aa8ef":["function (y) ","x"],"169521bb912b2":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplotly(p = nmi_balanced_div4)</code></pre>
<div id="htmlwidget-1eb1abdd26d5043349a2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1eb1abdd26d5043349a2">{"x":{"data":[{"x":[1,2,3],"y":[0.986953870125982,0.996152254090221,1],"text":["eff: eff110<br />nmi: 0.98695387<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 0.99615225<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 1.00000000<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.372387252051916,0.440724241041409,1],"text":["eff: eff110<br />nmi: 0.37238725<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 0.44072424<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 1.00000000<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0353920202640539,0.0796610736247378,0.459881783051234],"text":["eff: eff110<br />nmi: 0.03539202<br />methods: absnf<br />methods: absnf","eff: eff111<br />nmi: 0.07966107<br />methods: absnf<br />methods: absnf","eff: eff135<br />nmi: 0.45988178<br />methods: absnf<br />methods: absnf"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"absnf","legendgroup":"absnf","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3],"y":[0.569823788390343,0.767852725009227,1],"text":["eff: eff110<br />nmi: 0.56982379<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 0.76785273<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 1.00000000<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.320473056374424,0.331817797340434,0.780989296999579],"text":["eff: eff110<br />nmi: 0.32047306<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 0.33181780<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 0.78098930<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.028817834924769,0.0600089205579081,0.33969617868067],"text":["eff: eff110<br />nmi: 0.02881783<br />methods: concatenation<br />methods: concatenation","eff: eff111<br />nmi: 0.06000892<br />methods: concatenation<br />methods: concatenation","eff: eff135<br />nmi: 0.33969618<br />methods: concatenation<br />methods: concatenation"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"concatenation","legendgroup":"concatenation","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"frame":null},{"x":[1,2,3],"y":[0.395562697774526,0.404223991303626,0.406803340708451],"text":["eff: eff110<br />nmi: 0.39556270<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.40422399<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.40680334<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[0.325183146393696,0.356046884447838,0.397286115134023],"text":["eff: eff110<br />nmi: 0.32518315<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.35604688<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.39728612<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0264927283119962,0.0432235831313538,0.362784782121343],"text":["eff: eff110<br />nmi: 0.02649273<br />methods: gl<br />methods: gl","eff: eff111<br />nmi: 0.04322358<br />methods: gl<br />methods: gl","eff: eff135<br />nmi: 0.36278478<br />methods: gl<br />methods: gl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"gl","legendgroup":"gl","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"frame":null},{"x":[1,2,3],"y":[0.402500170483315,0.396105496946067,0.402855107893622],"text":["eff: eff110<br />nmi: 0.40250017<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 0.39610550<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 0.40285511<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.346422655131773,0.365316673230873,0.406746388306452],"text":["eff: eff110<br />nmi: 0.34642266<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 0.36531667<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 0.40674639<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.0269755749303578,0.0585573543016111,0.36940005785553],"text":["eff: eff110<br />nmi: 0.02697557<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff111<br />nmi: 0.05855735<br />methods: gl_nogl<br />methods: gl_nogl","eff: eff135<br />nmi: 0.36940006<br />methods: gl_nogl<br />methods: gl_nogl"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"gl_nogl","legendgroup":"gl_nogl","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"frame":null},{"x":[1,2,3],"y":[0.96878681731263,0.992237764802893,1],"text":["eff: eff110<br />nmi: 0.96878682<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 0.99223776<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 1.00000000<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null},{"x":[1,2,3],"y":[0.338697959844646,0.380023900925779,0.997519651270557],"text":["eff: eff110<br />nmi: 0.33869796<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 0.38002390<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 0.99751965<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null},{"x":[1,2,3],"y":[0.023328159644973,0.0354252952265613,0.396377504387166],"text":["eff: eff110<br />nmi: 0.02332816<br />methods: SNF<br />methods: SNF","eff: eff111<br />nmi: 0.03542530<br />methods: SNF<br />methods: SNF","eff: eff135<br />nmi: 0.39637750<br />methods: SNF<br />methods: SNF"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"SNF","legendgroup":"SNF","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"frame":null}],"layout":{"margin":{"t":55.4520547945205,"r":18.9954337899543,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"balanced_div4","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["eff110","eff111","eff135"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["eff110","eff111","eff135"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"annotations":[{"text":"eff","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"nmi","x":-0.0510980647966949,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"sig1","x":1,"y":0.840943683409437,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"sig10","x":1,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"sig100","x":1,"y":0.159056316590563,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"methods","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0.681887366818874,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0255054323727784,1.04883359201775],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.681887366818874,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.681887366818874,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.34855403348554,"y1":0.65144596651446},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.34855403348554,"y1":0.65144596651446,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.318112633181126},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.318112633181126,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.0255054323727784,1.04883359201775],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.34855403348554,0.65144596651446],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.0255054323727784,1.04883359201775],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.318112633181126],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1695251ce7c03":{"x":{},"y":{},"colour":{},"type":"scatter"},"169524b2fd2ea":{"x":{},"y":{},"colour":{}}},"cur_data":"1695251ce7c03","visdat":{"1695251ce7c03":["function (y) ","x"],"169524b2fd2ea":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="weight-comparison" class="section level2">
<h2>weight comparison</h2>
<pre class="r"><code>weight_2methods = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div4&quot;) %&gt;%
  dplyr::select(eff,sigma,type,gl = GL2, gl_nogl = GL2_nogl) %&gt;% 
  pivot_longer(
    gl:gl_nogl,
    names_to = &quot;methods&quot;,
    values_to = &quot;weights&quot;
  ) %&gt;% 
  ggplot(aes(x = factor(type), y = weights, color = methods))+
  geom_boxplot()+
  facet_grid(eff~sigma)

weight_gl = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div4&quot;) %&gt;%
  dplyr::select(eff,sigma,type,weights = GL2) %&gt;% 
  ggplot(aes(x = factor(type), y = weights))+
  geom_boxplot(color = &quot;red&quot;)+
  facet_grid(eff~sigma)+
  ggtitle(&quot;gl_weights&quot;)

weight_glno = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div4&quot;) %&gt;%
  dplyr::select(eff,sigma,type,weights = GL2_nogl) %&gt;% 
  ggplot(aes(x = factor(type), y = weights))+
  geom_boxplot(color = &quot;blue&quot;)+
  facet_grid(eff~sigma)+
  ggtitle(&quot;gl_nogl_weights&quot;)
  
weight_glno+weight_gl</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>weight_2methods_2 = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div2&quot;) %&gt;%
  dplyr::select(eff,sigma,type,gl = GL2, gl_nogl = GL2_nogl) %&gt;% 
  pivot_longer(
    gl:gl_nogl,
    names_to = &quot;methods&quot;,
    values_to = &quot;weights&quot;
  ) %&gt;% 
  ggplot(aes(x = factor(type), y = weights, color = methods))+
  geom_boxplot()+
  facet_grid(eff~sigma)

weight_gl_2 = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div2&quot;) %&gt;%
  dplyr::select(eff,sigma,type,weights = GL2) %&gt;% 
  ggplot(aes(x = factor(type), y = weights))+
  geom_boxplot(color = &quot;red&quot;)+
  facet_grid(eff~sigma)+
  ggtitle(&quot;gl_weights&quot;)

weight_glno_2 = as_tibble(gl_weight) %&gt;% 
  separate(scenario,into = c(&quot;ratio&quot;,&quot;eff&quot;,&quot;sigma&quot;,&quot;div&quot;), sep = &quot;_&quot;) %&gt;%
  filter(ratio == &quot;sub1111&quot;&amp;div == &quot;div2&quot;) %&gt;%
  dplyr::select(eff,sigma,type,weights = GL2_nogl) %&gt;% 
  ggplot(aes(x = factor(type), y = weights))+
  geom_boxplot(color = &quot;blue&quot;)+
  facet_grid(eff~sigma)+
  ggtitle(&quot;gl_nogl_weights&quot;)
  
weight_glno_2+weight_gl_2</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="explore-why-the-gl-simlr-perform-bad-on-div4" class="section level2">
<h2>explore why the GL-simlr perform bad on div4</h2>
<pre class="r"><code>library(rlist)
sim1 = simulation_3(data_divide = rep(&quot;1/2/3/4&quot;,3),sigma = rep(10,3))
# sim1 = simulation_3(sigma = rep(100,3))
mds_list = lapply(sim1[1:3], function(x){
  dist = dist2(x,x)
  mds = cmdscale(dist,2)
  return(mds)
})</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>g_sim1 = as_tibble(list.rbind(mds_list)) %&gt;% 
  mutate(data_type = rep(c(1,2,3), each = 200),
         true = rep(sim1$truelabel, 3)) %&gt;% 
  ggplot(aes(x = V1, y = V2, color = factor(true)))+
  geom_point()+
  facet_grid(data_type~., scale = &quot;free&quot;)

g_sim1</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>gl1 = gl_simlr(list(sim1$data1,sim1$data2,sim1$data3))</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>igraph::compare(sim1$truelabel, gl1$cluster, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.4786151</code></pre>
<pre class="r"><code># source(&quot;./code/R/network.diffusion.R&quot;)
# net.K = network.diffusion(gl1$K,K = 30)</code></pre>
<pre class="r"><code>w_snf = SNF(lapply(sim1[1:3], function(x) affinityMatrix(dist2(x))))
cluster_w1 = spectralClustering(w_snf,4)

igraph::compare(sim1$truelabel, cluster_w1, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code>## show the integrative matrix
diag(w_snf) = 0
heatmap(w_snf, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>heatmap(gl1$K, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-18-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>This simulation gives the scenario where the clusters are having different distances.</p>
<p>As we can see here, the SNF can use local similarity, which can diminish the influence from the original space structure which enlarging the similarity btw 13 and 24;</p>
<p>But for our gl-simlr, since we only add up all kernels with different weight, this weighted kernel can’t show any denoising effect, the low rank optimization also shows no effect.</p>
<div id="try-learn-the-similarity" class="section level3">
<h3>Try learn the similarity</h3>
<pre class="r"><code>rho = 0.5
alpha0 = 5
alpha = 5
beta = 10
gamma = 1
gl_s1 = Crazy_5term_clust(data_list = sim1[1:3], c=4, alpha0 = alpha0,alpha = alpha, rho = rho, beta = beta, gamma = gamma,normalize = 1)</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>cluster_s1 = spectralClustering(gl_s1$S, K = 4)
# net.S = network.diffusion(gl_s1$S, 30)
heatmap(gl_s1$S, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>igraph::compare(sim1$truelabel, cluster_s1, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.6456881</code></pre>
<p>Still bad performance relatively;</p>
<p>And this method performs extremely bad when div2</p>
<pre class="r"><code>sim2 = simulation_3(sigma = rep(10,3))

rho = 0.5
alpha0 = 1
alpha = 1
beta = 5
gamma = 5
gl_s2 = Crazy_5term_clust(data_list = sim2[1:3], c=4, alpha0 = alpha0,alpha = alpha, rho = rho, beta = beta, gamma = gamma,normalize = 1)</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>cluster_s2 = spectralClustering(gl_s2$S, K = 4)
# net.S = network.diffusion(gl_s2$S, 30)
heatmap(gl_s2$S, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>igraph::compare(sim1$truelabel, cluster_s2, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.01238309</code></pre>
<p>compare to the simple kernel weighted combination</p>
<pre class="r"><code>gl2 = gl_simlr(sim2[1:3])</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>igraph::compare(sim2$truelabel, gl2$cluster, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 1</code></pre>
</div>
</div>
<div id="question" class="section level2">
<h2>QUESTION:</h2>
<ol style="list-style-type: decimal">
<li>Why s can’t be learned properly?</li>
<li>How to combine these 2 scenario</li>
<li>How CIMLR perform on div2</li>
<li>How to capture the distance between clusters?</li>
</ol>
<div id="q1-why-s-cant-be-learned" class="section level3">
<h3>Q1 Why s can’t be learned?</h3>
<pre class="r"><code>## is local term make a difference?
kernels1 = lapply(sim1[1:3], FUN = function(x) D_kernels(x_fun = x,allk_fun = 50,sigma_fun = 1))</code></pre>
<pre><code>Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used

Warning in if (is.na(c)) {: the condition has length &gt; 1 and only the first
element will be used</code></pre>
<pre class="r"><code>local_kernels1 = lapply(kernels1, FUN = function(x) dominateset(x$Kernels,30))

heatmap(as.matrix(kernels1$data1$Kernels), Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>tmp = local_kernels1[[1]]
# diag(tmp) = 0
heatmap(tmp, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-22-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>cluster1 = spectralClustering(affinity = as.matrix(kernels1$data1$Kernels), K = 4,type = 3)
igraph::compare(cluster1, sim1$truelabel, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.3635537</code></pre>
<p>As we can see here, the current local Kernels can’t have local structures. which means the first 30 neighbours of the subjects are actually not within the same cluster;</p>
<pre class="r"><code>aff1 = affinityMatrix(dist2(sim1$data1)^(1/2))
local_aff1 = dominateset(aff1, 30)
cluster2 = spectralClustering(affinity = aff1, K = 4,type = 3)
diag(aff1) = 0 # just to show more clearly
# heatmap(aff1, Colv = NA, Rowv = NA, scale = &quot;column&quot;)
diag(local_aff1) = 0
heatmap(local_aff1, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>igraph::compare(cluster2, sim1$truelabel, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.802244</code></pre>
<p>But the affinitymatrix in SNFtool library can build kernels that holds the local structure; This would be derived from the 2 different sigma definition in the Gaussian kernel;</p>
<p>DISCUSS: Why the affinity matrix better capture the local structure?</p>
<div id="from-here-not-working-affinity_kernel-gl-simlr" class="section level4">
<h4>[FROM HERE: NOT WORKING] affinity_kernel gl-SIMLR</h4>
<p>MEMO: First review from the exploration why GL-smilr not working in div4, then check the affinitymatrix not working reason</p>
<p>since we need the local structure, try using affinity matrix as the kernels.</p>
<p>Although which kernel should be used can’t be pre-determined in real scenario, we can at least test whether the S and local kernels work</p>
<pre class="r"><code>rho = 0.5
alpha0 = 5
alpha = 5
beta = 1
gamma = 1
gl_s3 = Crazy_5term_clust(data_list = sim2[1:3], c=4, kernel_fun = &quot;affinity&quot;,alpha0 = alpha0,alpha = alpha, rho = rho, beta = beta, gamma = gamma,normalize = 1)
## FROM HERE
## why normalize == 2 can&#39;t be solved?


cluster_s3 = spectralClustering(gl_s3$S, K = 4)
# net.S = network.diffusion(gl_s3$S, 30)
# diag(net.S) = 0
tmp = gl_s3$S
diag(tmp) = 0
heatmap(gl_s3$S, Colv = NA, Rowv = NA, scale = &quot;column&quot;)</code></pre>
<p><img src="figure/GL_SIMLR.rmd/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># heatmap(net.S, Colv = NA, Rowv = NA, scale = &quot;column&quot;)

igraph::compare(sim1$truelabel, cluster_s2, method = &quot;nmi&quot;)</code></pre>
<pre><code>[1] 0.01238309</code></pre>
</div>
<div id="multiple-kernel-gl-simlr" class="section level4">
<h4>multiple kernel gl-SIMLR</h4>
<pre class="r"><code>## to add</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.2 (2019-12-12)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] rlist_0.4.6.1           plotly_4.9.2.1          directlabels_2020.12.29
 [4] patchwork_1.0.0         gplots_3.0.3            SIMLR_1.12.0           
 [7] quadprog_1.5-8          Matrix_1.2-18           igraph_1.2.5           
[10] SNFtool_2.3.0           abSNF_1.0.0             clValid_0.6-9          
[13] cluster_2.1.0           forcats_0.5.0           stringr_1.4.0          
[16] dplyr_0.8.5             purrr_0.3.3             readr_1.3.1            
[19] tidyr_1.0.2             tibble_3.0.0            ggplot2_3.3.0          
[22] tidyverse_1.3.0         workflowr_1.6.2        

loaded via a namespace (and not attached):
 [1] nlme_3.1-145       bitops_1.0-6       fs_1.4.1           lubridate_1.7.8   
 [5] RcppAnnoy_0.0.18   httr_1.4.1         rprojroot_1.3-2    tools_3.6.2       
 [9] backports_1.2.0    utf8_1.1.4         R6_2.5.0           KernSmooth_2.23-16
[13] lazyeval_0.2.2     DBI_1.1.0          colorspace_1.4-1   withr_2.1.2       
[17] tidyselect_1.0.0   compiler_3.6.2     git2r_0.26.1       cli_2.0.2         
[21] rvest_0.3.5        xml2_1.3.0         labeling_0.3       caTools_1.18.0    
[25] scales_1.1.0       digest_0.6.27      rmarkdown_2.1      pkgconfig_2.0.3   
[29] htmltools_0.4.0    prettyGraphs_2.1.6 dbplyr_1.4.2       htmlwidgets_1.5.1 
[33] rlang_0.4.10       readxl_1.3.1       rstudioapi_0.11    farver_2.0.3      
[37] generics_0.0.2     jsonlite_1.6.1     crosstalk_1.1.0.1  gtools_3.8.2      
[41] magrittr_1.5       heatmap.plus_1.3   Rcpp_1.0.5         munsell_0.5.0     
[45] fansi_0.4.1        lifecycle_0.2.0    stringi_1.4.6      whisker_0.4       
[49] yaml_2.2.1         grid_3.6.2         gdata_2.18.0       promises_1.1.0    
[53] crayon_1.3.4       lattice_0.20-41    haven_2.3.1        hms_0.5.3         
[57] knitr_1.28         pillar_1.4.3       codetools_0.2-16   reprex_0.3.0      
[61] glue_1.4.2         evaluate_0.14      data.table_1.12.8  alluvial_0.1-2    
[65] modelr_0.1.6       vctrs_0.3.6        httpuv_1.5.2       cellranger_1.1.0  
[69] gtable_0.3.0       ExPosition_2.8.23  assertthat_0.2.1   xfun_0.12         
[73] broom_0.5.5        pracma_2.2.9       RSpectra_0.16-0    later_1.0.0       
[77] viridisLite_0.3.0  class_7.3-16       ellipsis_0.3.1    </code></pre>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
